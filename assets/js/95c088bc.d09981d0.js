"use strict";(self.webpackChunkhashed_network_docs=self.webpackChunkhashed_network_docs||[]).push([[244],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return f}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(n),h=o,f=d["".concat(l,".").concat(h)]||d[h]||u[h]||i;return n?r.createElement(f,a(a({ref:t},p),{},{components:n})):r.createElement(f,a({ref:t},p))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,a=new Array(i);a[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:o,a[1]=s;for(var c=2;c<i;c++)a[c]=n[c];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},3346:function(e,t,n){n.r(t),n.d(t,{assets:function(){return l},contentTitle:function(){return a},default:function(){return d},frontMatter:function(){return i},metadata:function(){return s},toc:function(){return c}});var r=n(3117),o=(n(7294),n(3905));const i={title:"Bitcoin Orchestration",sidebar_position:4,tags:["NBV","bitcoin"]},a=void 0,s={unversionedId:"nbv",id:"nbv",title:"Bitcoin Orchestration",description:"Hashed Network Bitcoin Orchestration",source:"@site/docs/nbv.md",sourceDirName:".",slug:"/nbv",permalink:"/docs/nbv",draft:!1,tags:[{label:"NBV",permalink:"/docs/tags/nbv"},{label:"bitcoin",permalink:"/docs/tags/bitcoin"}],version:"current",sidebarPosition:4,frontMatter:{title:"Bitcoin Orchestration",sidebar_position:4,tags:["NBV","bitcoin"]},sidebar:"docs",previous:{title:"Component Overview",permalink:"/docs/intro"},next:{title:"Fund Administration",permalink:"/docs/fund_administration"}},l={},c=[{value:"Preface",id:"preface",level:3},{value:"Taproot Upgrade",id:"taproot-upgrade",level:2},{value:"No-Code Spending Policies",id:"no-code-spending-policies",level:2},{value:"Coin Control",id:"coin-control",level:2},{value:"Proof of Reserves",id:"proof-of-reserves",level:2}],p={toc:c};function d(e){let{components:t,...i}=e;return(0,o.kt)("wrapper",(0,r.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("head",null,(0,o.kt)("title",null,"Hashed Network Bitcoin Orchestration"),(0,o.kt)("meta",{charSet:"utf-8"}),(0,o.kt)("meta",{property:"og:image",content:"https://docs.hashed.network/img/taproot-example.png"}),(0,o.kt)("meta",{property:"og:description",content:"The bitcoin orchestrator generates the scripts and Schnoor addresses based on the configuration and business rules. The following diagram shows how a real-world spending policy would be translated to Tapscript and implemented with Hashed Network bitcoin orchestration."}),(0,o.kt)("meta",{property:"og:title",content:"Hashed Network Bitcoin Orchestration"}),(0,o.kt)("meta",{property:"og:url",content:"https://docs.hashed.network/docs/nbv"})),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"preface"},"Preface"),(0,o.kt)("p",null,"If you are unfamiliar with the Bitcoin Taproot upgrade and its implications, the following podcast is highly recommended."),(0,o.kt)("iframe",{src:"https://anchor.fm/chaincode/embed/episodes/Pieter-Wuille-and-Tim-Ruffing--Schnorr--MuSig--FROST-and-more---Episode-26-e1sav0l/a-a928f3k",height:"102px",width:"400px",frameborder:"0",scrolling:"no"}),(0,o.kt)("blockquote",null,(0,o.kt)("b",null,"Interviewer: ")," So the primary reason to adopt Schnorr is just makes building advanced signing protocols easier?"),(0,o.kt)("blockquote",null,(0,o.kt)("b",null,"Peter Wuille ")," (Bitcoin Core): That is the number one reason why we want this."),(0,o.kt)("hr",null),(0,o.kt)("p",null,"Recent innovations in bitcoin, such as ",(0,o.kt)("a",{parentName:"p",href:"https://en.bitcoin.it/wiki/BIP_0174"},"BIP 174"),", and the taproot upgrade, ",(0,o.kt)("a",{parentName:"p",href:"https://en.bitcoin.it/wiki/BIP_0340"},"BIP 340"),", ",(0,o.kt)("a",{parentName:"p",href:"https://en.bitcoin.it/wiki/BIP_0341"},"BIP 341"),", and ",(0,o.kt)("a",{parentName:"p",href:"https://en.bitcoin.it/wiki/BIP_0342"},"BIP 342"),", enables developers to de-couple the signing experience from the orchestration of transactions. For example, BIP 174 introduced the now widely supported partially signed bitcoin transaction (PSBT) format for multisignature wallets. "),(0,o.kt)("p",null,"Bitcoin orchestration is used to generate receiving addresses, verify ownership of treasuries, and proof of reserves reporting. The intermediate payloads (not private keys) may be encrypted or shared with a group. Compatible bitcoin signers include BlueWallet, in-browser via Hashed key vault, and more coming soon."),(0,o.kt)("p",null,"Users create an extended public key with their preferred signer, and verify that public key on Hashed Network (via QR code). When multiple users (or multiple accounts or security levels of the same user) attest to these keys on-chain, the pallet and off-chain workers orchestrate the process for signers. "),(0,o.kt)("p",null,"BIP 174 supports a limited number of signers per wallet, and lacks the scalability and privacy-preserving features of taproot."),(0,o.kt)("h2",{id:"taproot-upgrade"},"Taproot Upgrade"),(0,o.kt)("p",null,"Taproot upgrade functionality (340/341) preserves privacy because the outputs are always Schnoor signatures that make complex functionality and single addresses publicly indistinguishable. "),(0,o.kt)("p",null,"Pay-to-Taproot (P2TR) supports key and script aggregation in a hierarchy. This ",(0,o.kt)("strong",{parentName:"p"},"tree")," enables functionality for conditionally allowing spend of a UTXO. The Schnorr signature preserves privacy by only requiring a proof from the branch of the tree that satisfies the root condition."),(0,o.kt)("p",null,"As described by ",(0,o.kt)("a",{parentName:"p",href:"https://beincrypto.com/learn/taproot/"},"Moeller"),', it "provides user choice, meaning some transactions can be anonymous while others can stay public, depending on the use case. Tapscript validates these newer forms of transaction validity."'),(0,o.kt)("p",null,'The ability to nest tapscript conditions enables a variety of expressive "smart contract" style functionality to build into bitcoin spends. For example, require extended approvals for larger amounts, wait periods, and additional tiers of hardware signers.'),(0,o.kt)("p",null,"The bitcoin orchestrator generates the scripts and Schnoor addresses based on the configuration and business rules. The following diagram shows how a real-world spending policy would be translated to Tapscript and implemented with Hashed Network bitcoin orchestration. "),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"image",src:n(8375).Z,width:"1027",height:"702"})),(0,o.kt)("h2",{id:"no-code-spending-policies"},"No-Code Spending Policies"),(0,o.kt)("p",null,"The BDK provides tools like ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/bitcoindevkit/elephant"},"Elephant"),", which was used to construct the spending policy below. "),(0,o.kt)("p",null,"This policy expresses the rule that either the CEO can sign, both the CFO and COO, or either of them plus a 480 minute wait."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"image",src:n(5659).Z,width:"372",height:"311"})),(0,o.kt)("p",null,"The spending policy is used to generate the receiving address. The UTXO is created at that address when it receives bitcoin. Then, when it is time to spend the UTXO, the orchestration builds 3 verifiable payloads, routes them to be signed, and then merges and broadcasts the resulting transaction. "),(0,o.kt)("p",null,"With Schnorr key aggregation, no information about the spending policy is leaked. However, it is important for users to safely and securely manage the policy data to be able to reconstruct the signature requirements. "),(0,o.kt)("h2",{id:"coin-control"},"Coin Control"),(0,o.kt)("p",null,"Coin control allows users to organize, combine, label, and sweep UTXOs. Businesses map transactions to general ledger income or expense accounts for proper bookkeeping. Users can export these ledgers as text files to be used in ",(0,o.kt)("a",{parentName:"p",href:"https://www.hledger.org"},"hledger")," and other ",(0,o.kt)("a",{parentName:"p",href:"https://plaintextaccounting.org/"},"plain text accounting")," tools. See ",(0,o.kt)("a",{parentName:"p",href:"/docs/accounting/"},"On-chain Accounting")," for more."),(0,o.kt)("h2",{id:"proof-of-reserves"},"Proof of Reserves"),(0,o.kt)("p",null,'With coin control and accounting to properly manage the treasury, the information is well-organized for "proof-of-reserves". Treasurers can sign a single transaction that is combined with a report, that prove that the treasurer has access to the listed UTXOs.'),(0,o.kt)("h1",{id:"primary-benefits-of-bitcoin-orchestration"},"Primary Benefits of Bitcoin Orchestration"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Verifiable/trustless receiving addresses and tapscript"),(0,o.kt)("li",{parentName:"ul"},"Coin control for labeling and grouping UTXOs with policies"),(0,o.kt)("li",{parentName:"ul"},"Integration with triple entry accounting systems"),(0,o.kt)("li",{parentName:"ul"},"Proof-of-Reserves reporting"),(0,o.kt)("li",{parentName:"ul"},"Active notifications to prompt approvers for signatures"),(0,o.kt)("li",{parentName:"ul"},"Integration with common pallets such as ",(0,o.kt)("inlineCode",{parentName:"li"},"democracy")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"alliance"))))}d.isMDXComponent=!0},5659:function(e,t,n){t.Z=n.p+"assets/images/elephant-example-7f38937589ac6393983e0586d9d92611.png"},8375:function(e,t,n){t.Z=n.p+"assets/images/taproot-example-8664421a72ceb0eb8bf648c5ceca797a.png"}}]);